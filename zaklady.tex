\chapter{Základné pojmy a predošlé výsledky}

V tejto kapitole si zavedieme pojmy a označenia, ktoré budeme používať
vo zvyšku práce. Taktiež si podrobne popíšeme predošlé výsledky o
$L(2,1)$-farbeniach grafov, ktoré budú dôležité pre túto prácu.

Pokiaľ nebude povedané inak, grafy spomínané v tejto práci budú neorientované,
súvislé a jednoduché, bez slučiek a násobných hrán. Množinu vrcholov budeme
označovať $V(G)$ a množinu hrán $E(G)$. Vzdialenosť dvoch vrcholov $u$ a $v$
v grafe budeme označovať $d(u,v)$. 

Ako prvé si poriadne
zadefinujeme $L(2,1)$-farbenie grafu a problémy s ním súvisiace.

\begin{defn}
    $L(2,1)$-farbenie grafu $G$ je zobrazenie $\omega$, ktoré každému vrcholu priradí
    nezáporné celé číslo spĺňajúc nasledujúce podmienky:

    \begin{itemize}
        \item $d(u, v) = 1 \Rightarrow \left| \omega(u) - \omega(v) \right| \ge 2$
        \item $d(u, v) = 2 \Rightarrow \omega(u) \neq \omega(v)$
    \end{itemize}
\end{defn}

Pri obyčajných vrcholových, či hranových farbeniach grafov skúmame, aký
najmenší počet farieb potrebujeme pre platné ofarbenie daného grafu. Podobne
si vieme pri $L(2,1)$-farbeniach všímať, aké najväčšie číslo používajú. Toto
číslo budeme nazývať \emph{rozpätím $L(2,1)$-farbenia}. Najmenšie možné rozpätie
$L(2,1)$-farbenia grafu $G$ budeme nazývať \emph{$L(2,1)$-farbiace číslo} a
označovať $\lambda(G)$. Dôležité je všimnúť si, že $L(2,1)$-farbenie s
rozpätím $k$ môže používať až $k+1$ rôznych hodnôt.

Pod problémom $k$-$L(2,1)$-farbenia budeme rozumieť problém existencie farbenia
s rozpätím nanajvýš $k$. Podobne vieme zadefinovať problém $L(2,1)$-farbenia ako
hľadanie $\lambda(G)$. Keďže pre každý graf existuje triviálne ofarbenie
používajúce párne čísla od $0$ po $2n - 2$, z hľadiska výpočtovej zložitosti
sú tieto problémy takmer totožné.

Jedným z dôvodov, prečo je $L(2,1)$-farbeniam venovaná pozornosť, je ich uplatnenie
pri prideľovaní frekvenčných pásiem vysielacím staniciam. Kvôli interferencii
elektromagnetických vysielačov a prijímačov na podobných frekvenciách totiž
musia veľmi blízke vysielače dostať veľmi rozdielne pásmo, ale viac vzdialeným
vysielačom stačí menší rozdiel.

Aj keď je náš problém formulovaný jazykom celých čísel, už v prvých článkoch
venujúcich sa tejto problematike bola dokázaná ekvivalencia
nami definovaného problému so zovšeobecnením problému na reálne čísla\cite{griggs_yeh_tree}.

Keďže ide o modifikáciu problému farbenia grafov, je očakávateľné, že tento
problém bude $\mathcal{NP}$-ťažký, čo sa podarilo dokázať v tom istom článku.
Taktiež sa postupom času dokázala zložitosť problému aj na niektorých obmedzených
triedach grafov, napr. planárnych, bipartitných, dokonca aj na grafoch s
priemerom $2$\cite{color_survey}.

Ďalšou oblasťou skúmania boli dolné a horné ohraničenia na hodnotu $\lambda(G)$.
Vhodnou charakteristikou sa ukázal byť maximálny stupeň grafu. Pre všeobecné
grafy bolo najprv dokázané horné ohraničenie $\lambda(G) \leq \Delta^2 + 2\Delta$
pomocou jednoduchého pažravého priradenia\cite{griggs_yeh_tree},
ktoré bolo neskôr vylepšené na $\lambda(G) \leq \Delta^2 + \Delta$ s použitím
šikovnejšieho priradzovania\cite{chang_kuo}.

Pre špeciálne triedy grafov sa podarilo dokázať silnejšie ohraničenia. Napríklad
pre grafy s priemerom $2$ platí a je tesný odhad $\lambda(G) \leq \Delta^2$\cite{griggs_yeh_tree}
. Ďalej pre chordálne grafy platí odhad $\lambda(G) \leq \frac{\left( \Delta + 3 \right)^2}{4}$\cite{griggs_yeh_tree}
.

Medzi ďalšie triedy grafov, na ktorých sú dokázané tesnejšie obmedzenia na $L(2,1)$-farbiace
číslo, patria aj stromy s obmedzením $\Delta + 1 \leq \lambda(G) \leq \Delta + 2$\cite{griggs_yeh_tree},
kaktusy s obmedzením $\Delta + 1 \leq \lambda(G) \leq \Delta + 3$\cite{kaktusy} a vonkajšie planárne
grafy s obmedzením $\Delta + 1 \leq \lambda(G) \leq \Delta + 8$\cite{outer_planar_bound}.

Griggs a Yeh taktiež vyslovili hypotézu, že v každom grafe platí $\lambda(G) \leq \Delta^2$,
ktorá dodnes nebola vyriešená.

Ďalej sa pozrieme na zopár tried grafov, na ktorých vieme riešiť problém $L(2,1)$-farbenia
v polynomiálnom čase a popíšeme si zodpovedajúce algoritmy.

\section{Polynomiálne farbenie špeciálnych grafov}

Prvou triedou grafov, pre ktoré bol objavený polynomiálny algoritmus na riešenie
problému $k$-$L(2,1)$-farbenia, sú stromy\cite{chang_kuo}. Tento algoritmus si
podrobne popíšeme.

\subsection{Chang-Kuo algoritmus}

Vstupom pre algoritmus je strom $T$ zakorenený v listovom vrchole so synom $r$ a číslo $k$.
Tento algoritmus zistí, či existuje $L(2,1)$-farbenie grafu $T$ s rozpätím $k$.

Pre ľubovoľný
vrchol $v$ zadefinujeme $T(v)$ ako podstrom stromu $T$ zakorenený vo vrchole $v$. Taktiež
zadefinujeme $T'(v')$ ako $T(v)$ s novým vrcholom $v'$, ktorý je spojený iba s $v$, čiže
$$ G\left(V(T(v)) \cup \{ v' \}, E(T(v)) \cup \{ (v', v)\} \right) $$
kde $v'$ je nový vrchol nevyskytujúci sa v $T(v)$.

Základnou myšlienkou algoritmu je konštruovať množiny $S(T(v))$ definované nasledovne:
$$S(T(v)) = \{ (a, b) | \textrm{ existuje } L(2,1) \textrm{ farbenie } f \textrm{ grafu } T'(v') \textrm{ také, že } f(v) = a \textrm{ a } f(v') = b\}$$

Pre ľubovoľný listový vrchol $v_l$ ľahko vidíme, že 
$$S(T(v_l)) = \{ (a, b) | a \leq k \wedge b \leq k \wedge |a - b| \ge 2\}$$

Pre vnútorný vrchol $v$ so synmi $v_1, v_2, \ldots v_q$ vieme pre ľubovoľné $a, b, |a - b| \ge 2$ overiť,
či $(a, b) \in S(T(v))$ nasledovne:

\begin{enumerate}
    \item Zostrojíme bipartitný graf $G_{a,b}(v)$, ktorého jednou partíciou budú vrcholy $v_1, v_2 \ldots v_q$ a
    druhou partíciou hodnoty množiny $\{0, 1, \ldots k\}$ a ktorého množinu hrán zostrojíme nasledovne:
    $$E(G_{a,b}) = \{ (v_i, x) | x \neq b \wedge (a, x) \in S(T(v_i))\}$$
    \item Nájdeme najväčšie párenie na grafe $G_{a,b}$.
    \item Ak nájdené párenie má veľkosť $q$, potom $(a,b) \in S(T(v))$, inak $(a,b) \notin S(T(v))$.
\end{enumerate}

Do pozornosti dávame skutočnosť, že nájdené párenie zodpovedá priradeniu hodnôt vrcholom
$v_1, \ldots v_q$, pri ktorom je platné ohodnotenie vrcholov $v$ a $v'$ hodnotami $a$ a $b$.

Nakoniec $L(2,1)$-farbenie stromu $T$ s rozpätím $k$ existuje práve vtedy, keď je množina
$S(T(r))$ neprázdna.

Časová zložitosť tohto algoritmu je $O(n \cdot k^{4.5})$\cite{chang_kuo}. Neskôr sa objavili
mierne upravené algoritmy s lepšou časovou zložitosťou.

\subsection{Zlepšenia Chang-Kuo algoritmu}

Prvý zlepšujúci algoritmus urýchľuje konštrukciu
párení tak, že najprv nájde základné párenie bez obmedzení spôsobených priradením hodnoty $b$
vrcholu $v'$.

Pre overenie každej dvojice $(a,b)$ vo vrchole $v$ teda stačí nájsť jedno základné
párenie pre každé $a$. Priradenie farby $b$ vrcholu $v'$ môže odstrániť nanajvýš jednu hranu z párenia,
tú, ktorá spája nejaký vrchol s hodnotou $b$. 

Vďaka tomu vieme overiť existenciu párenia v Chang-Kuo algoritme hľadaním nanajvýš
jednej zlepšujúcej cesty. Ďalšie zlepšenie vyplýva z využitia predspracovania stromu popísaného
už v článku s pôvodným algoritmom. Vďaka nemu sa dá vstupný strom zredukovať tak, aby každý
listový vrchol bol hranou spojený s vrcholom maximálneho stupňa v grafe\cite{chang_kuo}.

Dôslednou analýzou 
zložitosti dostaneme celkovú časovú zložitosť vylepšeného algoritmu $O(n^{1.75})$\cite{chang_kuo_improv}.

Pri poslednom zlepšení algoritmu riešiaceho problém $L(2,1)$-farbenia autori zavádzajú
pojem kompatibility ohodnotenia vrcholov, vďaka ktorému dokážu viaceré farby vrcholu $v$
spracovať naraz. Časová zložitosť algoritmu bude lineárna od veľkosti vstupného stromu\cite{chang_kuo_linear}.

\subsection{Cyklové stromy a vonkajšie planárne grafy}

Ďalšími triedami grafov s polynomiálnymi algoritmami sú cyklové stromy\cite{kaktusy} a vonkajšie
planárne grafy\cite{outer_planar}.

\begin{defn}
    Cyklový strom je graf, v ktorom každý vrchol leží na najviac jednej kružnici.
\end{defn}

\begin{defn}
    Vonkajší planárny graf je planárny graf, pre ktorý existuje rovinné nakreslenie, v ktorom
    všetky vrcholy ležia vo vonkajšej oblasti.
\end{defn}

Oba algoritmy fungujú principiálne podobne ako algoritmus pre stromy v tom, že lokálne pre
nejakú množinu vrcholov zisťujú, aké všetky kombinácie hodnôt im môžu byť priradené na
základe rovnakej informácie pre blízke okolité body, ktorých v týchto triedach grafov nie je
príliš veľa.

\section{Farbenie všeobecných grafov}

Paralelne k výskumu špeciálnych tried grafov, na ktorých sa dá riešiť problém $L(2,1)$-farbenia,
sa skúmajú algoritmy schopné riešiť tento problém na všeobecných grafoch. Keďže ide o problém,
ktorého exponenciálne riešenia majú pomerne veľký základ, pre časovú zložitosť budeme používať
$O^*$-notáciu, pri ktorej sa neuvádzajú ani násobné polynomiálne faktory.

S prvým význačným riešením tohto problému prišiel D. Kráľ, keď vyriešil všeobecnejší problém
priradzovania kanálov (channel assignment problem). Pre problém $L(2,1)$-farbenia z neho 
jednoduchou úpravou vstupu vznikol algoritmus s časovou zložitosťou $O^*(4^n)$\cite{kral_channel}.

S lepšími algoritmami prišli Havet a kol. Prezentujú algoritmus pre problém $4$-$L(2,1)$-farbenia
s časovou zložitosťou $O^*(1.3009^n)$ a algoritmus pre riešenie problému $L(2,1)$-farbenia s
časovou zložitosťou $O^*(3.8730^n)$.

Algoritmy na riešenie všeobecného problému sa postupom času vylepšovali spolu s približovaním
horných a dolných odhadov. Aktuálne najlepším algoritmom pre všeobecné grafy je algoritmus
od Junosza-Szaniawskeho a kol., ktorého časová zložitosť je $O^*(2.6488^n)$\cite{junosza_fast}.
Tento algoritmus budeme ďalej nazývať ako algoritmus Junosza-Szaniawski.

\subsection{Algoritmus Junosza-Szaniawski}

Na začiatok si zadefinujeme dôležité pojmy $2$\emph{-pakovania} a vlastných párov, ktoré budeme
viackrát potrebovať pri popise algoritmu.

\begin{defn}
    Podmnožinu $S$ vrcholovej množiny grafu $G$ nazývame $2$\emph{-pakovaním} grafu $G$, pokiaľ každé
    dva vrcholy v $S$ majú vzdialenosť aspoň $3$ v grafe $G$.
\end{defn}

\begin{defn}
    Usporiadanú dvojicu $(S, X)$ podmnožín vrcholovej množiny grafu $G$ nazývame \emph{vlastný pár}
    grafu $G$, ak $S \cap X = \emptyset$ a $S$ je $2$-pakovaním grafu $G$.

    Počet všetkých vlastných párov grafu $G$ budeme označovať $pp(G)$. Najväčšiu hodnotu $pp(G)$
    spomedzi všetkých $k$-vrcholových \emph{súvislých} grafov budeme označovať $pp(k)$.
\end{defn}

\begin{pozn}
    \label{pp_g}
    Počet vlastných párov grafu $G$ vieme vypočítať nasledovne:
    $$pp(G) = \sum_{\substack{S \in \mathcal{P}(V_G) \\ S \textrm{ je } 2 \textrm{-pakovanie}}} 2^{n - |S|}$$
\end{pozn}

Základnou myšlienkou algoritmu je vytvárať všetky čiastočné $L(2,1)$-farbenia s obmedzeným rozpätím.
Tieto čiastočné farbenia rozdelíme do tabuliek $T_0, T_1, \ldots T_{2n}$ a budeme kódovať pomocou
$n$-znakových reťazcov nad abecedou $\{0, \bar{0}, 1, \bar{1}\}$. Tabuľka $T_k$ bude obsahovať
reťazec $a$ práve vtedy, keď existuje čiastočné $L(2,1)$-farbenie $f$ s rozpätím $k$ a s nasledujúcimi vlastnosťami:

\begin{enumerate}
    \item $a_i = 0$ ak je vrchol $v_i$ neohodnotený farbením $f$ a \emph{neexistuje} vrchol susediaci s $v_i$ ofarbený farbou $k$,
    \item $a_i = \bar{0}$ ak je vrchol $v_i$ neohodnotený farbením $f$ a \emph{existuje} vrchol susediaci s $v_i$ ofarbený farbou $k$,
    \item $a_i = 1$ ak $f(i) < k$,
    \item $a_i = \bar{1}$ ak $f(i) = k$.
\end{enumerate}

Tabuľku $T_i$ vieme vypočítať z tabuľky $T_{i-1}$ tak, že vezmeme každý reťazec z $T_{i-1}$, každé
$2$-pakovanie grafu $P$ a vrcholom obsiahnutým v $P$ priradíme farbu $i$. Takéto priradenie farieb
vieme pekne reprezentovať ako operáciu po jednotlivých znakoch na reťazcoch.

Najprv si zadefinujeme čiastočné zobrazenie $\oplus : \{ 0, \bar{0}, 1, \bar{1}\} \times \{ 0, 1 \} \rightarrow \{0, 1, \bar{1}\}$
nasledujúcou tabuľkou:

\begin{tabular}{c | c c c c}
    $\oplus$ & $0$ & $\bar{0}$ & $1$ & $\bar{1}$ \\
    \hline
    $0$ & $0$ & $0$ & $1$ & $1$ \\
    $1$ & $\bar{1}$ & -- & -- & -- \\
\end{tabular}

Znakom -- označujeme nedefinovanú hodnotu.

Ďalej zobrazenie prirodzene rozšírime na reťazce a množiny reťazcov:
\begin{equation}
    a_1 a_2 \ldots a_n \oplus b_1 b_2 \ldots b_n =
      \begin{cases}
          \begin{gathered}
            (a_1 \oplus b_1)(a_2 \oplus b_2) \ldots \\
            \ldots (a_n \oplus b_n)  
          \end{gathered} &
          \begin{aligned}
            & \textrm{ak je } a_i \oplus b_i \textrm{ definované} \\ 
            & \textrm{pre každé } i \in \{0, \ldots n\} 
          \end{aligned} \\
        \textrm{nedefinované} & \textrm{ inak}
      \end{cases}
\end{equation}

$$A \oplus B = \{ a \oplus b | a \in A \wedge b \in B \wedge a \oplus b \textrm{ je definované} \} $$

Pri počítaní $T_i$ teda najprv vypočítame $T_{i-1} \oplus P$, kde $P$ je množina všetkých $2$-pakovaní, kde
každé $2$-pakovanie prirodzene reprezentujeme ako Booleovský reťazec dĺžky $n$. Nakoniec zmeníme $0$ na $\bar{0}$ pre
všetky vrcholy, ktoré susedia s vrcholom farby $i$.

Posledným stavebným kameňom algoritmu je spôsob, ako rýchlo počítať $A \oplus B$. Principiálne
sa bude tento postup podobať na Strassenov algoritmus. Graf $G$ si rozdelíme na niekoľko podgrafov
$G_1, G_2, \ldots G_q$ tak, aby s vopred zvoleným $k$ platilo:

\begin{enumerate}
    \item $\forall v \in V(G) \exists j : v \in V(G_j)$
    \item $\forall j \in \{2, 3, \ldots q \} : |V(G_j)| \ge k$
    \item $\forall j \in \{ 1, 2, \ldots q \} : |V(G_j)| \leq 2k$
    \item $\sum_{j=1}^q |V(G_j)| \leq n(1 + \frac{1}{k})$
\end{enumerate}

Pre množinu reťazcov $A$ a reťazec $w$ zadefinujeme množinu suffixov $w$ v $A$ ako $A_w = \{v | wv \in A\}$.
S takýmto označením vieme potom výpočet $A \oplus B$ rozdeliť na dve časti nasledovne:
$$A \oplus B = \bigcup_{\substack{u \in \{0, \bar{0}, 1, \bar{1}\}^p \\ v \in \{0, 1\}^p \\ [u \oplus v \textrm{ je definované}]} }
(u \oplus v)(A_u \oplus B_v) = \bigcup_{\substack{v \in \{0, 1\}^p \\ w \in \{0, 1, \bar{1}\}^p}}
w \left[ \left( \bigcup_{\substack{u \in \{0, \bar{0}, 1, \bar{1}\}^p \\ [u \oplus v = w] }} A_u \right) \oplus B_v \right]$$

Z definície zobrazenia $\oplus$ na reťazcoch vidíme, že ak je pre dané $v$ a $w$ prázdna množina
$$ \bigcup_{\substack{u \in \{0, \bar{0}, 1, \bar{1}\}^p \\ [u \oplus v = w] }} A_u,$$
výpočet sa pre túto dvojicu môže ukončiť.

Z predpisu zobrazenia $\oplus$ vidíme, že $v_i = 1$ práve vtedy, keď $w_i = \bar{1}$. Pre dané
$v$ preto môže existovať nanajvýš $2^{p - \|v\|}$, kde $\|v\|$ označuje počet jednotkových znakov
vo $v$. Počet dvojíc $v$ a $w$, pre ktoré existuje nejaké platné $u$ teda vieme zhora ohraničiť
hodnotou
$$\sum_{v \in \{0, 1\} 2^{p - \|v\|}}.$$

Keďže v algoritme vykonávame operáciu $T_i \oplus P$, kde $P$ sú reťazce zodpovedajúce
$2$-pakovaniam grafu $G$ a grafy $G_1, G_2, \ldots G_q$, podľa ktorých budeme operáciu $T_i \oplus P$
deliť na menšie časti, sú súvislé, vieme túto sumu vyjadriť ako $pp(p)$\ref{pp_g}.

Keďže súčet počtov vrcholov v grafoch $G_1 \ldots G_q$ je $n' \leq n(1 + \frac{1}{k})$, kde
$n' \ge n$, v reťazcoch z výpočtu $T_i \oplus P$ budeme mať pre niektoré vrcholy viacero
nezávislých pozícií kodujúcich ich stav ofarbenia. Všetky reťazce, v ktorých bude niektorý
vrchol zároveň ofarbený aj neofarbený, z množiny odstránime. Keďže reťazce sú polynomiálne
dlhé v závislosti od $n$, túto kontrolu vieme pre každý reťazec vykonať v polynomiálnom čase.

\subsection{Analýza časovej zložitosti algoritmu Junosza-Szaniawski}

Pre odhad časovej zložitosti najprv odhadneme počet reťazcov, ktoré môžu vzniknúť pri počítaní
$T_i \oplus P$.

